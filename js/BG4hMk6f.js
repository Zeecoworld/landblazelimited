import{u as N,_ as V}from"./BgHkq_PJ.js";import{d as _,a as A,v as u,i as l,aR as D,j as F,ac as T,aS as W,c as r,k as y}from"./ChUMkS6P.js";import{i as G}from"./DzFfo68f.js";import{g as J}from"./cuZZCMxh.js";const K=t=>t>600?t*.03:t>400?t*.025:t*.015,te=_({name:"BackgroundImage",props:{image:{type:Object,required:!0},imageResize:{type:Object},settings:{type:Object},widget:{type:Object},index:{type:Number,default:0},isMobile:{type:Boolean,default:!1},isEnabledParallaxEffect:{type:Boolean,default:!0}},setup(t,{slots:n}){const k=A(),m=k.getSite,s=t.settings,c=u(null),p=u(0),i=u(null),g=u(null),f=u(!1),z=l(()=>k.getIsMobile),b=l(()=>J(t.widget,t.imageResize,t.index)),I=l(()=>D(t.image,b.value)),O=l(()=>{const e=I.value,a=N();return a?a(e,{format:"webp",quality:90}):e}),S=l(()=>{var e;return(e=t.image)!=null&&e.alt?t.image.alt:(m==null?void 0:m.title)||"hocoos"}),C=l(()=>{var e;return((e=b.value)==null?void 0:e.width)||null}),d=l(()=>{var e;return((e=b.value)==null?void 0:e.height)||null}),P=l(()=>({backgroundImage:`url(${O.value})`,minHeight:`${d.value}px`})),j=l(()=>{const e={};return e.transform=`translate3d(0, ${p.value}%, 0) scale(1.3)`,e}),$=l(()=>{if(F(s))return!1;const e=(s==null?void 0:s.imageStyle)||{};return!G(e==null?void 0:e.isEnabledBlur)}),v=l(()=>!t.isEnabledParallaxEffect||z.value?!1:(s==null?void 0:s.isEnabledParallaxEffect)||!1),M=()=>{try{i.value=new IntersectionObserver(R,{threshold:.5})}catch(e){console.log(e)}},R=e=>{try{e==null||e.forEach(a=>{a.isIntersecting?f.value=!0:f.value=!1})}catch(a){console.log(a)}},U=(e,a,w,o,L)=>(e-a)/(w-a)*(L-o)+o,h=()=>{var e;try{if(q()){const a=(e=c.value)==null?void 0:e.getBoundingClientRect(),w=a.top,o=a.height;g.value==null&&(g.value=K(o)),p.value=U(w,0,o,0,-g.value)}}catch(a){console.log(a)}},q=()=>c.value&&i.value?(i.value.observe(c.value),f.value):!1,E=()=>{try{g.value=null,h()}catch(e){console.log(e)}},B=()=>{try{window==null||window.requestAnimationFrame(()=>{h()})}catch(e){console.log(e)}},x=(e,a={})=>r(V,{src:I.value,alt:S.value,loading:"lazy",quality:90,format:"webp",style:a,class:y("kmb-bg-widget-image-item",e),"data-width":C.value,"data-height":d.value},null),H=()=>t.isMobile?r("div",{class:"kmb-widget-bg-image-content"},[x("kmb-widget-bg-mobile-image w-full"),n.default&&r("div",{class:"kmb-widget-bg-image-mobile-content w-full"},[n.default({})])]):r("div",{class:"kmb-widget-bg-image-content"},[r("div",{class:"kmb-widget-bg-image",style:P.value,"data-height":d.value},[n.default&&n.default({})])]);return T(()=>{v.value&&(M(),h(),window==null||window.addEventListener("scroll",B,!1),window==null||window.addEventListener("resize",E,!1))}),W(()=>{v.value&&(window==null||window.removeEventListener("scroll",B,!1),window==null||window.removeEventListener("resize",E,!1),i.value&&i.value.disconnect())}),{root:c,height:d,hasCustomBlur:$,parallaxBgStyle:j,isEnabledBgParallaxEffect:v,renderImage:x,renderBackgroundImageContent:H}},render(){var t,n;return this.isEnabledBgParallaxEffect?r("div",{ref:"root",class:y("kmb-widget-bg-image-item kmb-parallax-wrapper",{"kmb-widget-bg-has-custom-blur":this.hasCustomBlur}),style:`min-height: ${this.height}px;`},[r("div",{class:"kmb-widget-bg-image","data-height":this.height},[this.renderImage("kmb-widget-bg-parallax-image",this.parallaxBgStyle)]),r("div",{class:"kmb-widget-bg-image-content"},[((t=this.$slots)==null?void 0:t.default)&&((n=this.$slots)==null?void 0:n.default({}))])]):r("div",{ref:"root",class:y("kmb-widget-bg-image-item",{"kmb-widget-bg-has-custom-blur":this.hasCustomBlur})},[this.renderBackgroundImageContent()])}});export{te as B};
