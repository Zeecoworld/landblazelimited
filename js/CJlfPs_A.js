import{d as $,b as P,C as V,L as N,a as U,v as k,U as x,i as S,c as s,K as A,k as i,z as C,M as _,j as L}from"./ChUMkS6P.js";import{n}from"./BVv2S30c.js";import{a as T}from"./BsqA6tUc.js";import{F as v}from"./B-lU7qM5.js";import{F as y}from"./xwgnLmIi.js";import"./CyET3sau.js";import"./D9Hbs_0D.js";import"./A9nCysFq.js";import"./CeHZR0Ph.js";function j(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!C(e)}const K=$({name:"SignUp",async setup(){const{$api:e}=P(),d=V(),p=N(),r=U(),l=k(!1),c=k(null),t=k(new x),u=S(()=>r.clientSession),m=S(()=>{var f;const{isValid:g,containsUppercase:h,containsNumber:w,containsSpecial:o,minLength:b}=T((f=t==null?void 0:t.value)==null?void 0:f.password);return{isValid:g,containsUppercase:h,containsNumber:w,containsSpecial:o,minLength:b}}),a=async g=>{var h,w;g.preventDefault();try{l.value=!0;const o=await e.post(new x({...t.value}));if(o&&o.userId){const b=await e.post(new _({provider:"site_credentials",userName:(h=t.value)==null?void 0:h.email,password:(w=t.value)==null?void 0:w.password}));await r.setClientSession(b);const f=d.query.redirect||"/",R=p.resolve(f);window.open(R.href,"_self")}}catch(o){console.log(o),c.value=o.responseStatus||g}finally{l.value=!1}};return await(async()=>{L(u.value)||await r.signout()})(),{onSubmit:a,validation:m,responseStatus:c,registerResponse:t}},render(){var d,p,r,l,c,t,u,m;let e;return s("div",{class:"kmb-site-page flex items-center"},[s("div",{class:"kmb-sign-up-page kmb-sm-widget-container"},[s("h1",{class:"text-center kmb-widget-title-h2 kmb-widget-title-no-divider kmb-widget-col-group-no-margin"},[this.$t("authentification.creatingAnAccount")]),s("div",{class:"mb-kmb-xl-group text-center kmb-widget-text-body1 mt-2"},[`${this.$t("authentification.alreadyHaveOne")} `,s(A,{to:"/login",class:"kmb-form-link underline"},j(e=this.$t("authentification.loginToYourAccount"))?e:{default:()=>[e]})]),s("form",{ref:"form",onSubmit:a=>this.onSubmit(a),class:"kmb-form-login"},[s("div",{class:"kmb-widget-contact-form-wrap"},[s("div",{class:"kmb-widget-form w-full"},[s("div",{class:"kmb-default-group kmb-user-name-field-group mb-8"},[s(y,{label:this.$t("labels.email"),class:"kmb-password-block"},{default:()=>[s(v,{modelValue:this.registerResponse.email,"onUpdate:modelValue":a=>this.registerResponse.email=a,id:n("email"),fieldName:n("email"),responseStatus:this.responseStatus,placeholder:this.$t("labels.emailAddress")},null)]})]),s("div",{class:"kmb-default-group mb-8"},[s("div",{class:i("kmb-user-password-field-group",{"kmb-user-password-field-group-error":!((d=this.validation)!=null&&d.isValid)&&((r=(p=this.registerResponse)==null?void 0:p.password)==null?void 0:r.length)})},[s(y,{label:this.$t("authentification.password"),class:"kmb-password-block"},{default:()=>[s(v,{type:"password",modelValue:this.registerResponse.password,"onUpdate:modelValue":a=>this.registerResponse.password=a,id:n("password"),fieldName:n("password"),responseStatus:this.responseStatus,placeholder:this.$t("authentification.password"),maxlength:64,isEbaledTogglePasswordType:!0},null)]})]),((l=this.registerResponse)==null?void 0:l.password)&&s("ul",{class:"password-security-roles flex items-center"},[s("li",{class:i("password-security-role",{"password-security-role-ok":this.validation.containsUppercase})},[s("img",{width:9,height:9,class:i("password-security-role-img"),src:this.validation.containsUppercase?"/images/ok-icon.svg":"/images/cancel-icon.svg"},null),s("span",{class:"kmb-widget-text-body1"},[this.$t("authentification.uppercaseLetter")])]),s("li",{class:i("password-security-role mx-4",{"password-security-role-ok":this.validation.minLength})},[s("img",{width:9,height:9,class:i("password-security-role-img"),src:this.validation.minLength?"/images/ok-icon.svg":"/images/cancel-icon.svg"},null),s("span",{class:"kmb-widget-text-body1"},[this.$t("authentification.eightToSixtyfourCharacters")])]),s("li",{class:i("password-security-role",{"password-security-role-ok":this.validation.containsNumber})},[s("img",{width:9,height:9,class:i("password-security-role-img"),src:this.validation.containsNumber?"/images/ok-icon.svg":"/images/cancel-icon.svg"},null),s("span",{class:"kmb-widget-text-body1"},[this.$t("authentification.number")])])])]),s("div",{class:"kmb-default-group kmb-user-password-field-group mb-8"},[s("div",{class:i("kmb-user-password-field-group",{"kmb-user-password-field-group-error":!((c=this.validation)!=null&&c.isValid)&&((u=(t=this.registerResponse)==null?void 0:t.password)==null?void 0:u.length)})},[s(y,{label:this.$t("labels.confirmPassword"),class:"kmb-password-block"},{default:()=>[s(v,{type:"password",modelValue:this.registerResponse.confirmPassword,"onUpdate:modelValue":a=>this.registerResponse.confirmPassword=a,id:n("confirmPassword"),fieldName:n("confirmPassword"),responseStatus:this.responseStatus,placeholder:this.$t("labels.confirmPassword"),maxlength:64,isEbaledTogglePasswordType:!0},null)]}),this.registerResponse.password!=this.registerResponse.confirmPassword&&((m=this.registerResponse.confirmPassword)==null?void 0:m.length)>0&&s("ul",{class:"password-security-roles  flex items-center"},[s("li",{class:i("password-security-role",{"password-security-role-ok":this.registerResponse.password==this.registerResponse.confirmPassword})},[s("img",{width:9,height:9,class:i("password-security-role-img"),src:this.registerResponse.password==this.registerResponse.confirmPassword?"/images/ok-icon.svg":"/images/cancel-icon.svg"},null),s("span",{class:"kmb-widget-text-body1"},[this.$t("authentification.passwordMismatch")])])])])]),s("div",{class:"kmb-default-group text-center mt-8"},[s("button",{id:"sign-up-button",class:"kmb-widget-btn w-full"},[this.$t("authentification.createAnAccount")])])])])])])])}});export{K as default};
