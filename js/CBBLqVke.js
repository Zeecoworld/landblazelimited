import{aP as h,j as q,d,u as x,aQ as R,i as y,c as l,k as L}from"./ChUMkS6P.js";const v=(t,e)=>{if(t===e)return!0;if(t==null||e==null)return t===e;if(typeof t!="object"||typeof e!="object"||t.constructor!==e.constructor)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let a=0;a<t.length;a++)if(!v(t[a],e[a]))return!1;return!0}if(t instanceof Map){if(!(e instanceof Map)||t.size!==e.size)return!1;for(let[a,s]of t)if(!e.has(a)||!v(s,e.get(a)))return!1;return!0}if(t instanceof Set){if(!(e instanceof Set)||t.size!==e.size)return!1;for(let a of t)if(!e.has(a))return!1;return!0}if(t instanceof Date)return!(!(e instanceof Date)||t.getTime()!==e.getTime());if(t instanceof RegExp)return!(!(e instanceof RegExp)||t.toString()!==e.toString());const i=Object.keys(t),u=Object.keys(e);if(i.length!==u.length)return!1;for(let a of i)if(!e.hasOwnProperty(a)||!v(t[a],e[a]))return!1;return!0};class O{static async mergeToRoute(e,i,u){const a=(i==null?void 0:i.query)||{},s=Object.assign({},a,u),r=h.removeEmptyFields(s);v(r,a)||await e.push({query:r})}static async appendToRoute(e,i,u){await e.push({query:Object.assign({},i.query,u)})}static async removeFromRoute(e,i,u){const a=Object.assign({},(i==null?void 0:i.query)||{});q(a)||delete a[u],await e.push({query:a})}}class C{static maxLimit(e=10){return Math.min(e||10)}static pageCount(e=0,i=10){const u=this.maxLimit(i);return Math.ceil(e/u)}static currentPage(e=0,i=10){const u=this.maxLimit(i);return Math.ceil(e/u+1)}}const m=C,w=d({name:"Pagination",props:{query:{type:Object,required:!0},queryResponse:{type:Object,required:!0},isDisabledUpdateUrl:{type:Boolean,default:!1}},emits:["paginate"],setup(t,{emit:e}){const i=x(),u=R(),a=y(()=>{const{take:n}=t.query;return m.maxLimit(n)}),s=y(()=>{const{take:n}=t.query,{total:c}=t.queryResponse;return m.pageCount(c,n)}),r=y(()=>{const{take:n}=t.query,{offset:c}=t.queryResponse;return m.currentPage(c,n)}),k=y(()=>{let n=4;if(n%4===0&&(n+=1),s.value<=n)return o(1,s.value+1);const c=r.value<n,g=s.value-r.value<n-2;return r.value+1==n?s.value-1==n?[1,0].concat(o(n-2,s.value+1)):o(1,n+1).concat([0,s.value]):c||g?c?o(1,n).concat([0,s.value]):[1,0].concat(o(s.value-3,s.value+1)):[1,0].concat(r.value-2,r.value-1,r.value,r.value+1).concat([0,s.value])}),o=(n,c,g=1)=>Array(Math.ceil((c-n)/g)).fill(n).map((P,p)=>P+p*g),f=async()=>{if(t.isDisabledUpdateUrl){e("paginate",t.query);return}const n={page:m.currentPage(t.query.skip,t.query.take)};await O.mergeToRoute(u,i,n),e("paginate",t.query)};return{maxLimit:a,pagination:k,currentPage:r,onPage:n=>{n&&(t.query.skip=(n-1)*a.value,f())},onPrevPage:()=>{r.value>1&&(t.query.skip=(r.value-2)*a.value,f())},onNextPage:()=>{r.value*a.value<t.queryResponse.total&&(t.query.skip=r.value*a.value,f())},onFirstPage:()=>{t.query.skip=0,f()},onLastPage:()=>{t.query.skip=(s.value-1)*a.value,f()}}},render(){var t;if(this.queryResponse.total>this.maxLimit)return l("div",{class:"kmb-pagination"},[l("ul",{class:"kmb-pagination-list"},[l("li",null,[l("button",{class:"kmb-first-page",onClick:()=>this.onFirstPage()},[this.$t("buttons.first")])]),l("li",null,[l("button",{class:"kmb-pagination-nav kmb-previous-page kmb-site-icon-angle-left",onClick:()=>this.onPrevPage()},null)]),(t=this.pagination)==null?void 0:t.map(e=>l("li",{"data-pagination-page":e},[l("button",{disabled:e==0,class:L("kmb-pagination-page-item",{"kmb-pagination-current-page":this.currentPage==e}),onClick:()=>this.onPage(e)},[e||"..."])])),l("li",null,[l("button",{class:"kmb-pagination-nav kmb-next-page kmb-site-icon-angle-right",onClick:()=>this.onNextPage()},null)]),l("li",null,[l("button",{class:"kmb-last-page",onClick:()=>this.onLastPage()},[this.$t("buttons.last")])])])])}});export{w as P,O as R,m as a};
