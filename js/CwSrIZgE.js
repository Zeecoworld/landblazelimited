import{d as k,b as v,e as S,v as b,i as g,j as C,aD as D,c as t,du as I,dt as x,k as p,dP as L,ec as M,dO as F,dQ as N}from"./ChUMkS6P.js";import{n as h}from"./BVv2S30c.js";import{V as B,a as E,D as V}from"./DsvMmw88.js";import{W as T}from"./ClCWloev.js";import{W}from"./ah8qzS9z.js";import{B as _}from"./QreLNsmH.js";import{D as j}from"./B7AWbE-9.js";import{F as O}from"./B-lU7qM5.js";import{I as z}from"./uNGU_bZw.js";import{M as A}from"./CuhE2MTX.js";const K=k({name:"MarketingSubscribeForm",props:{form:{type:Object,default:()=>new W},source:{type:String,default:"Widget subscribe form"},formGroupClassNames:{type:String,default:"flex"},isEnabledAnimation:{type:Boolean,default:!1},animateClassName:{type:String,default:"animate__fadeInUp"}},setup(s){const{$api:n}=v(),d=S(),a=b([]),r=b(!1),m=b(void 0),o=b({email:null}),f=g(()=>({email:new B({name:"Email",type:E.Email})})),u=g(()=>{var e,i;return C((e=s.form)==null?void 0:e.style)?new T:(i=s.form)==null?void 0:i.style}),l=g(()=>{const e=a.value.find(i=>i.fieldName=="email");return e?e.message:null}),y=async()=>{try{const e=await n.getSingle(new N({siteId:d,isDefault:!0,fields:[h("id"),h("name")].join(",")}));return(e==null?void 0:e.id)||null}catch(e){console.log(e)}},w=async e=>{try{e.preventDefault(),a.value=[];const i=V(f.value,o.value);a.value=i.errors||[],i!=null&&i.isValid&&(r.value=!0,s.form.mailingListId||(s.form.mailingListId=await y()),s.form.mailingListId&&await n.post(new F({email:o.value.email,source:s.source,siteId:d,mailingListId:s.form.mailingListId}))&&(m.value=!0,o.value={email:null},e.target.reset()))}catch(i){const c=i;c.responseStatus&&c.responseStatus.message&&a.value.push({fieldName:"email",message:c.responseStatus.message})}finally{r.value=!1}};return D(()=>{m.value=void 0}),{style:u,error:l,formData:o,isLoading:r,isShowConfirmationModal:m,onSubmitForm:w}},render(){var s,n,d,a,r,m,o,f,u;return t("div",{class:p("kmb-widget-mailing-list-subscribe-form w-full",{"kmb-widget-form-has-label-color":!!((s=this.style)!=null&&s.labelColor),"kmb-widget-form-has-field-color":!!((n=this.style)!=null&&n.fieldColor),"kmb-widget-form-has-border-color":!!((d=this.style)!=null&&d.fieldBorderColor)}),style:{"--label-color":(a=this.style)==null?void 0:a.labelColor,"--field-color":(r=this.style)==null?void 0:r.fieldColor,"--field-border-color":(m=this.style)==null?void 0:m.fieldBorderColor,"--field-background-color":(o=this.style)==null?void 0:o.fieldBackgroundColor}},[I(t("form",{class:"kmb-widget-subscribe-form",onSubmit:async l=>await this.onSubmitForm(l)},[t("div",{class:p("kmb-widget-subscribe-form-group kmb-site-default-dir",this.formGroupClassNames)},[t(O,{modelValue:this.formData.email,"onUpdate:modelValue":l=>this.formData.email=l,placeholder:((u=(f=this.form.inputPlaceholder)==null?void 0:f.lczText)==null?void 0:u.lczValue)||this.$t("messages.enterYourEmailHere"),error:this.error,class:"kmb-widget-subscribe-field kmb-submit-form-field kmb-site-placeholder-field-group w-full"},null),t(L,{value:this.form.button,type:"submit",isLoading:this.isLoading,elementType:M.Primary,class:"kmb-submit-form-btn"},null)])]),[[x("animate-onscroll"),{className:`animate__animated ${this.animateClassName}`,isEnabled:this.isEnabledAnimation}]]),t(A,{modalType:"xsDefault",isOpened:this.isShowConfirmationModal,classes:"kmb-site-confirmation-modal kmb-site-pop-up-widget kmb-site-pop-up-widget-confirmation-modal",onClose:l=>{this.isShowConfirmationModal=l}},{default:()=>[t("div",{class:"kmb-site-confirmation-modal-wrap kmb-site-subscribe-confirmation-wrap text-center"},[t("div",{class:"kmb-widget-form-group text-center flex flex-col items-center"},[t(_,{value:this.form.confirmationTitle,tag:"h2",class:"kmb-site-confirmation-modal-title kmb-site-subscribe-form-header kmb-widget-title-h2"},null),t(j,{value:this.form.confirmationDescription,class:"kmb-site-confirmation-modal-form-message kmb-success-sumbit-form-message kmb-site-subscribe-form-text"},null),t(z,{value:this.form.confirmationImage,resize:{width:197,height:197}},null)])])]})])}});export{K as M};
