import{b as P,e as y,a as m,f as S,t as b,g as v,ab as h,d as l,h as w,ac as k,j as x,c as p,k as A,ad as _,C}from"./ChUMkS6P.js";import{g as $}from"./jn2WeL0S.js";import{u as E}from"./DSb9Sqaw.js";import{u as R,P as T}from"./vB1of1f_.js";import{_ as j}from"./jrEy4lmL.js";import{i as N}from"./D2MfSaGS.js";import{R as M}from"./Ckh8S67_.js";import"./DSoJ1F4P.js";import"./CeHZR0Ph.js";import"./DwDAZxOX.js";const O=async(a,c,o)=>{const{$api:r}=P(),e=y(),s=m(),n=S(`useProduct-${e}-${a||c}`,()=>({data:null})),t=async(u,d)=>{const{data:i,error:g}=await v(`product-${e}-${u||d}`,async()=>{try{return await r.getSingle(new h({siteId:e,includeSku:!0,isEnabledViwedCounter:!0,skuCount:-1,id:u?+u:void 0,slug:u?void 0:d}))}catch{}});return R(g.value,i.value,"Product not found"),E(i.value),s.setPage(i.value),n.value.data=i.value,i};return typeof o=="function"&&await o(t),{fetchProduct:t,...b(n.value)}},V=O,q=l({name:"WebSiteProductPageTemplate",props:{site:{type:Object,required:!0},page:{type:Object,required:!0}},setup(a){const{title:c,meta:o}=N(a.page);w({title:c,meta:o,titleTemplate:"Store | %s",bodyAttrs:{class:["kmb-site-app-body","kmb-site-store-body","kmb-product-template-default"]}});const r=e=>{try{if(!e)return;const s=_("viewedProducts",{maxAge:365*24*60*60}),t=[...s.value||[]];t.findIndex(d=>d==e)===-1&&t.unshift(e),s.value=t}catch(s){console.log(s)}};k(()=>{var e;r((e=a.page)==null?void 0:e.id)})},render(){if(!x(this.page))return p("div",{class:"kmb-site-page"},[p(j,null,{default:()=>[p("div",{class:A(T(this.page)),"data-page-template-type":this.page.pageTemplateType},[M(this.page,this.site)])]})])}}),K=l({name:"Product",async setup(){const a=C(),o=m().getSite,{id:r,slug:e,urlSlug:s}=$(a),{data:n}=await V(r,e,async t=>await t(r,e));return{site:o,product:n}},render(){return p(q,{site:this.site,page:this.product},null)}});export{K as default};
